from sklearn.model_selection import train_test_split
import pandas as pd
from model import train_logistic_regression_model
from model import train_random_forest_model
import argparse
import logging
import joblib
import os

# logging.basicConfig(
#     filename='../logs/application.log',
#     level=logging.INFO,
#     filemode='w',
#     format='%(name)s - %(levelname)s - %(message)s')

artifacts_path = "./artifacts/"


def train_model(classifier: str) -> None:
    """ train model with provided classifier option
    Args:
        classifier (str): classfier option, either LR (Logistic Regression) or RF (Random Forest)
    """

    try:
        # load the data and labels artifacts generated by processing data
        X_train = joblib.load(os.path.join(artifacts_path, "data_test.joblib"))
        y_train = joblib.load(os.path.join(
            artifacts_path, "labels_test.joblib"))
    except FileNotFoundError:
        print("Artifatcs not found. Please run the process data module first!!")
        return

    # Split the data into training and testing sets
    X_train, X_test, y_train, y_test = train_test_split(
        X_train, y_train, test_size=0.2, random_state=42)

    if classifier == "RF":
        train_random_forest_model(X_train, X_test, y_train, y_test)
    else:
        train_logistic_regression_model(X_train, X_test, y_train, y_test)


if __name__ == "__main__":

    parser = argparse.ArgumentParser(
        description='Train model, either with Logistic Regression or Random Forest!')

    parser.add_argument('-c', '--classifier', type=str,
                        default='LR', help='Classifier name, either LR or RF')

    args = parser.parse_args()
    classifier = args.classifier
    train_model(classifier)
